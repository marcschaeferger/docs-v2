---
title: "OAuth2/OIDC"
description: "Configure OpenID Connect identity provider for external authentication"
---

This identity provider follows the OpenID Connect protocol. This means that it can be used to connect to any external identity provider that supports the OpenID Connect protocol such as Authentik, Keycloak, Okta, etc.

## Creating a Generic OAuth2/OIDC IdP in Pangolin

In Pangolin, go to "Identity Providers" and click "Add Indentity Provider". Select the OAuth2/OIDC provider option.

<Frame>
  <img src="/images/create-oidc-idp.png" />
</Frame>

In the OAuth2/OIDC Configuration, you'll need the following fields:

<ResponseField name="Client ID" type="string" required>
  The client identifier provided by your identity provider.
</ResponseField>

<ResponseField name="Client Secret" type="string" required>
  The client secret provided by your identity provider.
</ResponseField>

<ResponseField name="Authorization URL" type="string" required>
  The authorization endpoint URL from your identity provider.
</ResponseField>

<ResponseField name="Token URL" type="string" required>
  The token endpoint URL from your identity provider.
</ResponseField>

## Token Configuration

Use JMESPath to select attributes from the claims token. See [JMESPath](https://jmespath.org/) for more information on how to use JMESPath.

Determine how to access information from the claims token returned by the identity provider. This is used to map the user information from the identity provider to the user information in Pangolin.

<ResponseField name="Identifier Path" type="string" required>
  This must be unique for each user within an identity provider.
  
  **Example**: `sub` or `user_id`
</ResponseField>

<ResponseField name="Email Path" type="string">
  Path to the user's email address in the claims token.
  
  **Example**: `email`
</ResponseField>

<ResponseField name="Name Path" type="string">
  Path to the user's display name in the claims token.
  
  **Example**: `name` or `preferred_username`
</ResponseField>

<ResponseField name="Scopes" type="string">
  The scopes to request from the identity provider (not JMESPath; must be space-delimited strings).
  
  **Default**: `openid profile email`
  
  <Note>
  Generally, `openid profile email` is sufficient for most use cases.
  </Note>
</ResponseField>

## If your IdP is hosted behind the same Pangolin stack

When your OpenID Connect (OIDC) provider is also served **through this Pangolin stack** (e.g. via Traefik on the same host) and your IdP URL like `https://idp.example.com` points to this host, containers in the stack must resolve the IdP hostname **internally** for callbacks and token exchanges.

Add the IdP domain as a **Docker network alias** on the service exposing ports `80`/`443` inside the compose network:

<Tabs>
  <Tab title="Traefik shares gerbil netns">
  Traefik uses `network_mode: service:gerbil` and therefore reuses gerbil's network namespace.
  ```yaml
  services:
    gerbil:
      networks:
        default:
          aliases:
            - idp.example.com  # IdP hostname resolves internally
      ports:
        - 443:443
        - 80:80

    traefik:
      network_mode: "service:gerbil"
  ```
  </Tab>
  <Tab title="Traefik has own netns">
  Traefik runs in its own namespace and directly exposes 80/443.
  ```yaml
  services:
    traefik:
      networks:
        default:
          aliases:
            - idp.example.com
      ports:
        - 443:443
        - 80:80
  ```
  </Tab>
</Tabs>

<Info>
Public DNS remains unchanged. The alias only affects **internal service-to-service resolution** for OIDC redirects and token/userinfo requests.
</Info>

### When to add the alias

* You host the IdP behind the same Traefik/Pangolin stack.
* OIDC flows originate from containers that must reach the IdP hostname internally (authorization callback, token exchange, userinfo).

### If Traefik runs elsewhere

If Traefik is external (different host or Kubernetes), ensure internal DNS resolves the IdP domain appropriately (CoreDNS override, /etc/hosts, or service alias in that environment).

<Tip>
Remove the alias only if all OIDC flows successfully resolve the IdP via public DNS from within the stack (hairpin NAT working). Keeping the alias avoids edge cases.
</Tip>
